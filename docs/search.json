[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Species i in site j",
    "section": "",
    "text": "Two early career ecologists pondering on things, ecology, R, and all that.\nMax Lindmark is a Researcher at the Institute of Marine Research – SLU Aqua\nFederico Maioli is a PhD student at the University of Bologna"
  },
  {
    "objectID": "posts/latandlon/index.html",
    "href": "posts/latandlon/index.html",
    "title": "From Decimal Minutes to Decimal Degrees for your analysis",
    "section": "",
    "text": "It might happen that Latitude and Longitude of your spatially referenced data are formatted like this c(4530.12, 1310.02), i.e. as Decimal Minutes (D° M.M’). This is likely not a friendly a format for your analysis. However, with this function you can convert it to the more R friendly format Decimal Degrees (D.D°). The function was provided me by Patrik Börjesson (SLU Aqua)."
  },
  {
    "objectID": "posts/latandlon/index.html#reproducible-example",
    "href": "posts/latandlon/index.html#reproducible-example",
    "title": "From Decimal Minutes to Decimal Degrees for your analysis",
    "section": "Reproducible example",
    "text": "Reproducible example\n\nlat.dm.m = 4530.12\nlat.d.d = format.position(lat.dm.m)\nlat.d.d\n\n[1] 45.5"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Species i in site j",
    "section": "",
    "text": "Order By\n       Default\n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Title\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\n\nDate\n\n\nTitle\n\n\nAuthor\n\n\nReading Time\n\n\n\n\n\n\n\n\n\nFeb 3, 2023\n\n\nExemplifying random effects with a fish growth dataset\n\n\nMax Lindmark\n\n\n4 min\n\n\n\n\n\n\n\nSep 18, 2022\n\n\nFrom Decimal Minutes to Decimal Degrees for your analysis\n\n\nFederico Maioli\n\n\n0 min\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/random_effects/index.html",
    "href": "posts/random_effects/index.html",
    "title": "Exemplifying random effects with a fish growth dataset",
    "section": "",
    "text": "library(RCurl)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(patchwork)\nlibrary(viridis)\nlibrary(lme4)\nlibrary(ggplot2); theme_set(theme_light())\n# Discrete colors\nscale_colour_discrete <- function(...) {\n  scale_colour_viridis(discrete = TRUE, option = \"cividis\")\n}\n\n# Read, crop and clean data\nd <- readr::read_csv(\"https://raw.githubusercontent.com/maxlindmark/warm-life-history/master/data/for_fitting/growth_scaling_dat.csv\") %>% \n  filter(area == \"FM\" & catch_age == 6) %>% \n  dplyr::select(length, catch_age, back_calc_age, ID) %>% \n  filter(ID %in% head(unique(ID), 50)) %>% # filter 50 individuals\n  rename(age = back_calc_age) %>% \n  mutate(age_sq = age*age)\n\nFirst plot the data to see what we are trying to estimate (how length relates to age):\n\n# Plot length vs age, we'll use a polynomial to account for the curvature\nggplot(d, aes(age, length)) + \n  geom_point() + \n  stat_smooth(method = \"lm\", formula = y ~ poly(x, 2))\n\n\n\n\nNow we can fit a model of length as a function of age (and a squared term just because it isn’t exactly linear in this age-range).\n\n# First a simple lm\nm <- lm(length ~ age + age_sq, data = d)\n\nsummary(m)\n\n\nCall:\nlm(formula = length ~ age + age_sq, data = d)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3148 -0.9154 -0.0156  0.8760  3.7220 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.21080    0.42298   2.863  0.00456 ** \nage          5.80080    0.32234  17.996  < 2e-16 ***\nage_sq      -0.39600    0.05271  -7.513 1.06e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.395 on 247 degrees of freedom\nMultiple R-squared:  0.9256,    Adjusted R-squared:  0.925 \nF-statistic:  1536 on 2 and 247 DF,  p-value: < 2.2e-16\n\n\nThe residuals look nice! Or?\n\n# Extract residuals\nd$res_m <- residuals(m)\n\n# Plot!\nggplot(d, aes(res_m)) + \n  geom_histogram() + \n  labs(x = \"residuals simple linear regression\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\nIf we group them by individual fish we see something…\n\nggplot(d, aes(ID, res_m, color = ID)) + \n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\") + \n  labs(y = \"residuals from random slope and intercept model\")\n\n\n\n\nMany boxes do not really overlap 0 when grouped by individual like this. Observations within an individual tend to all be above or below the average! As an example, we can plot the average size at age 1 for two groups: individuals that are below and above the mean size when they are age 5. We see that individuals that are bigger when 5 years where also on average bigger as 1 year olds.\n\nd5 <- d %>% \n  filter(age == 5) %>% \n  mutate(mean_length = mean(length)) %>% \n  mutate(big_ind = ifelse(length > mean_length, \"Yes\", \"No\")) %>% \n  dplyr::select(big_ind, ID)\n\nd %>% left_join(d5, by = \"ID\") %>% \n  filter(age == 1) %>% \n  ggplot(aes(big_ind, length)) + \n  geom_boxplot(width = 0.2, fill = NA) + \n  geom_jitter(height = 0, width = 0.1) + \n  labs(x = \"bigger than average as a 5 year old?\")\n\n\n\n\nHow to deal with this? We can let the variable ID interact with age. This gives every individual a unique slope and intercept.\n\n# First a simple lm\nm2 <- lm(length ~ age*ID + age_sq, data = d)\n\n# Extract residuals\nd$res_m2 <- residuals(m2)\n\n# Make data long for plotting\nd %>% \n  pivot_longer(c(res_m, res_m2)) %>% \n  mutate(name2 = ifelse(name == \"res_m\", \"No ID effect\", \"Age*ID interaction\")) %>% \n  ggplot(aes(ID, value, color = ID)) + \n  facet_wrap(~name2, ncol = 1) +\n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\")\n\n\n\n\nWhile the issues with the residuals got “fixed”, it wasn’t cheap. Just look at the summary table:\n\nsummary(m2)\n\n\nCall:\nlm(formula = length ~ age * ID + age_sq, data = d)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-2.132 -0.428  0.013  0.411  1.432 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       0.3080     0.7584   0.406 0.685236    \nage               6.3160     0.2728  23.149  < 2e-16 ***\nID1987346FM      -0.5900     1.0399  -0.567 0.571340    \nID1987347FM       3.5900     1.0399   3.452 0.000724 ***\nID1987348FM       1.5800     1.0399   1.519 0.130805    \nID1987353FM       1.2500     1.0399   1.202 0.231278    \nID1987354FM       0.5600     1.0399   0.538 0.591044    \nID1987360FM       2.6400     1.0399   2.539 0.012157 *  \nID1987365FM       1.8700     1.0399   1.798 0.074176 .  \nID1987376FM       0.4000     1.0399   0.385 0.701057    \nID1987383FM       0.7900     1.0399   0.760 0.448663    \nID1987389FM       2.0200     1.0399   1.942 0.053974 .  \nID1987390FM      -0.6000     1.0399  -0.577 0.564843    \nID1987393FM       1.0300     1.0399   0.990 0.323569    \nID1987399FM       2.4800     1.0399   2.385 0.018350 *  \nID1987403FM       0.1400     1.0399   0.135 0.893093    \nID1987404FM       0.7600     1.0399   0.731 0.466046    \nID1987407FM       0.9000     1.0399   0.865 0.388196    \nID1987412FM       0.5600     1.0399   0.538 0.591044    \nID1987420FM       0.9600     1.0399   0.923 0.357437    \nID1987423FM       1.5900     1.0399   1.529 0.128405    \nID1987429FM       3.6500     1.0399   3.510 0.000593 ***\nID1987440FM       2.0700     1.0399   1.990 0.048367 *  \nID1987445FM       0.8600     1.0399   0.827 0.409581    \nID1987449FM       1.0700     1.0399   1.029 0.305196    \nID1987451FM       2.8200     1.0399   2.712 0.007482 ** \nID1987452FM       0.6600     1.0399   0.635 0.526633    \nID1987453FM       0.7700     1.0399   0.740 0.460210    \nID1987458FM      -0.5100     1.0399  -0.490 0.624567    \nID1987464FM      -1.7200     1.0399  -1.654 0.100248    \nID1987465FM       1.3600     1.0399   1.308 0.192971    \nID1987470FM      -0.2200     1.0399  -0.212 0.832748    \nID1987476FM       0.2300     1.0399   0.221 0.825267    \nID1987482FM       0.2700     1.0399   0.260 0.795509    \nID1987485FM       0.5300     1.0399   0.510 0.611058    \nID1987492FM      -1.0600     1.0399  -1.019 0.309722    \nID1987493FM      -0.2300     1.0399  -0.221 0.825267    \nID1987494FM       0.9100     1.0399   0.875 0.382959    \nID1987498FM      -0.5100     1.0399  -0.490 0.624567    \nID1987499FM      -0.3800     1.0399  -0.365 0.715329    \nID1987529FM      -0.4600     1.0399  -0.442 0.658893    \nID1987530FM       1.1400     1.0399   1.096 0.274757    \nID1987532FM      -0.6600     1.0399  -0.635 0.526633    \nID1987535FM       0.2000     1.0399   0.192 0.847756    \nID1987539FM       1.9000     1.0399   1.827 0.069699 .  \nID1987545FM      -0.1900     1.0399  -0.183 0.855281    \nID1987567FM       1.3900     1.0399   1.337 0.183390    \nID1987579FM      -0.4600     1.0399  -0.442 0.658893    \nID1988310FM       1.5700     1.0399   1.510 0.133241    \nID1988317FM       4.4700     1.0399   4.298 3.09e-05 ***\nID1988337FM       3.7400     1.0399   3.596 0.000438 ***\nage_sq           -0.3960     0.0265 -14.943  < 2e-16 ***\nage:ID1987346FM  -0.0900     0.3136  -0.287 0.774489    \nage:ID1987347FM  -1.1100     0.3136  -3.540 0.000534 ***\nage:ID1987348FM  -0.3600     0.3136  -1.148 0.252760    \nage:ID1987353FM  -0.5500     0.3136  -1.754 0.081475 .  \nage:ID1987354FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987360FM  -1.3400     0.3136  -4.274 3.42e-05 ***\nage:ID1987365FM  -0.6700     0.3136  -2.137 0.034249 *  \nage:ID1987376FM   0.0200     0.3136   0.064 0.949227    \nage:ID1987383FM  -0.0100     0.3136  -0.032 0.974601    \nage:ID1987389FM  -0.9600     0.3136  -3.062 0.002612 ** \nage:ID1987390FM   0.0400     0.3136   0.128 0.898662    \nage:ID1987393FM  -0.3700     0.3136  -1.180 0.239877    \nage:ID1987399FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987403FM  -0.5000     0.3136  -1.595 0.112919    \nage:ID1987404FM  -0.4000     0.3136  -1.276 0.204052    \nage:ID1987407FM   0.0200     0.3136   0.064 0.949227    \nage:ID1987412FM  -0.3200     0.3136  -1.021 0.309122    \nage:ID1987420FM  -0.7800     0.3136  -2.488 0.013963 *  \nage:ID1987423FM  -0.6100     0.3136  -1.945 0.053607 .  \nage:ID1987429FM  -1.0500     0.3136  -3.349 0.001028 ** \nage:ID1987440FM  -0.0100     0.3136  -0.032 0.974601    \nage:ID1987445FM  -0.8000     0.3136  -2.551 0.011738 *  \nage:ID1987449FM  -0.7100     0.3136  -2.264 0.024996 *  \nage:ID1987451FM  -0.7000     0.3136  -2.232 0.027077 *  \nage:ID1987452FM  -0.9000     0.3136  -2.870 0.004698 ** \nage:ID1987453FM  -0.1700     0.3136  -0.542 0.588514    \nage:ID1987458FM  -0.1900     0.3136  -0.606 0.545469    \nage:ID1987464FM   0.3800     0.3136   1.212 0.227468    \nage:ID1987465FM  -0.3800     0.3136  -1.212 0.227468    \nage:ID1987470FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987476FM   0.1500     0.3136   0.478 0.633079    \nage:ID1987482FM  -0.8300     0.3136  -2.647 0.008993 ** \nage:ID1987485FM  -0.5100     0.3136  -1.626 0.105956    \nage:ID1987492FM  -0.1000     0.3136  -0.319 0.750233    \nage:ID1987493FM  -0.4700     0.3136  -1.499 0.136007    \nage:ID1987494FM  -0.4900     0.3136  -1.563 0.120241    \nage:ID1987498FM  -0.4300     0.3136  -1.371 0.172324    \nage:ID1987499FM  -0.5000     0.3136  -1.595 0.112919    \nage:ID1987529FM  -0.9200     0.3136  -2.934 0.003875 ** \nage:ID1987530FM  -0.8800     0.3136  -2.807 0.005678 ** \nage:ID1987532FM  -0.4600     0.3136  -1.467 0.144473    \nage:ID1987535FM  -0.6600     0.3136  -2.105 0.036980 *  \nage:ID1987539FM  -0.7400     0.3136  -2.360 0.019570 *  \nage:ID1987545FM  -0.7500     0.3136  -2.392 0.018008 *  \nage:ID1987567FM  -0.6900     0.3136  -2.201 0.029307 *  \nage:ID1987579FM  -0.6800     0.3136  -2.169 0.031695 *  \nage:ID1988310FM  -0.5500     0.3136  -1.754 0.081475 .  \nage:ID1988317FM  -1.1900     0.3136  -3.795 0.000214 ***\nage:ID1988337FM  -1.9400     0.3136  -6.187 5.63e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7011 on 149 degrees of freedom\nMultiple R-squared:  0.9887,    Adjusted R-squared:  0.981 \nF-statistic: 129.8 on 100 and 149 DF,  p-value: < 2.2e-16\n\n\nThat’s a lot parameters to estimate, and it’s not even parameters we are interested in! We just wanted to fix the residual issues. We are seeking the average intercept and slope in this population, not the intercept and slope of each fish.\nEnter random effects! There are a few different reasons for why you would want to model effects as random factors. Here’s a more thorough example on the topic. In our case, we just want to control for systematic variation from our use of multiple data points per individual.\nWe consider two cases here: (1) within ID’s, there’s a negative correlation between intercept and slope and (2) intercepts and slopes vary among individuals (see the (x|ID) addition). We fit these using the lme4 package.\n\n# Random intercept only\nm3 <- lmer(length ~ age + age_sq + (1|ID), data = d)\n\n# Random intercept and slope\nm4 <- lmer(length ~ age + age_sq + (1 + age|ID), data = d)\n\n# We can compare them with AIC. Random intercept is more parsimonious\nAIC(m3, m4)\n\n   df      AIC\nm3  5 781.4218\nm4  7 739.4287\n\n\nThere seems to be support for both intercepts and age slopes to vary among individuals based on AIC. We can now have a look at the model:\n\n# Inspect the model\nsummary(m4)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: length ~ age + age_sq + (1 + age | ID)\n   Data: d\n\nREML criterion at convergence: 725.4\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-3.13579 -0.59883  0.03232  0.64076  1.83217 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n ID       (Intercept) 1.2051   1.0977        \n          age         0.1324   0.3639   -0.50\n Residual             0.4916   0.7011        \nNumber of obs: 250, groups:  ID, 50\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)   1.2108     0.2633   4.599\nage           5.8008     0.1700  34.115\nage_sq       -0.3960     0.0265 -14.943\n\nCorrelation of Fixed Effects:\n       (Intr) age   \nage    -0.814       \nage_sq  0.705 -0.935\n\n\nHere we see two things: our fixed effects are now our population level estimates, from which each individual deviate, and that the intercept and age slope are very correlated. What about the residuals?\n\n# Extract residuals\nd$res_m4 <- residuals(m4)\n\nggplot(d, aes(ID, res_m4, color = ID)) + \n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\") + \n  labs(y = \"residuals from random slope and intercept model\")\n\n\n\n\nBeautiful! And this is just an example. With the full data set once could further explore adding a fixed effect of area (warm/cold) and different random effect structures and models. But for now, that’s it!"
  },
  {
    "objectID": "posts/random_effects/index.html#fit-models",
    "href": "posts/random_effects/index.html#fit-models",
    "title": "Exemplifying random effects",
    "section": "Fit models!",
    "text": "Fit models!\n\n# First a simple lm\nm <- lm(length ~ age + age_sq, data = d)\n\nsummary(m)\n\n\nCall:\nlm(formula = length ~ age + age_sq, data = d)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3148 -0.9154 -0.0156  0.8760  3.7220 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.21080    0.42298   2.863  0.00456 ** \nage          5.80080    0.32234  17.996  < 2e-16 ***\nage_sq      -0.39600    0.05271  -7.513 1.06e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.395 on 247 degrees of freedom\nMultiple R-squared:  0.9256,    Adjusted R-squared:  0.925 \nF-statistic:  1536 on 2 and 247 DF,  p-value: < 2.2e-16\n\n# Extract residuals\nd$res_lm <- residuals(m)\n\nggplot(d, aes(res_lm)) + \n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\nThey look nice! Or?\n\nggplot(d, aes(ID, res_lm, color = ID)) + \n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\")\n\n\n\n\nIt seems that many boxes do not really overlap 0 when grouped by individual like this. Observations within an individual tend to all be above or below the average! We can plot this\n\nd5 <- d %>% \n  filter(age == 5) %>% \n  mutate(mean_length = mean(length)) %>% \n  mutate(big_ind = ifelse(length > mean_length, \"Y\", \"N\")) %>% \n  dplyr::select(big_ind, ID)\n\nd %>% left_join(d5, by = \"ID\") %>% \n  filter(age == 1) %>% \n  ggplot(aes(big_ind, length)) + \n  geom_boxplot(width = 0.2, fill = NA) + \n  geom_jitter(height = 0, width = 0.1) + \n  labs(x = \"Bigger than average as a 5 year old?\")\n\n\n\n\n\nggplot(d, aes(ID, res_lm, color = ID)) + \n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\")\n\n\n\n\nHow to deal with this? We can add an ID effect (both intercept and slope)\n\n# First a simple lm\nm2 <- lm(length ~ age*ID + age_sq, data = d)\n\nsummary(m2)\n\n\nCall:\nlm(formula = length ~ age * ID + age_sq, data = d)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-2.132 -0.428  0.013  0.411  1.432 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       0.3080     0.7584   0.406 0.685236    \nage               6.3160     0.2728  23.149  < 2e-16 ***\nID1987346FM      -0.5900     1.0399  -0.567 0.571340    \nID1987347FM       3.5900     1.0399   3.452 0.000724 ***\nID1987348FM       1.5800     1.0399   1.519 0.130805    \nID1987353FM       1.2500     1.0399   1.202 0.231278    \nID1987354FM       0.5600     1.0399   0.538 0.591044    \nID1987360FM       2.6400     1.0399   2.539 0.012157 *  \nID1987365FM       1.8700     1.0399   1.798 0.074176 .  \nID1987376FM       0.4000     1.0399   0.385 0.701057    \nID1987383FM       0.7900     1.0399   0.760 0.448663    \nID1987389FM       2.0200     1.0399   1.942 0.053974 .  \nID1987390FM      -0.6000     1.0399  -0.577 0.564843    \nID1987393FM       1.0300     1.0399   0.990 0.323569    \nID1987399FM       2.4800     1.0399   2.385 0.018350 *  \nID1987403FM       0.1400     1.0399   0.135 0.893093    \nID1987404FM       0.7600     1.0399   0.731 0.466046    \nID1987407FM       0.9000     1.0399   0.865 0.388196    \nID1987412FM       0.5600     1.0399   0.538 0.591044    \nID1987420FM       0.9600     1.0399   0.923 0.357437    \nID1987423FM       1.5900     1.0399   1.529 0.128405    \nID1987429FM       3.6500     1.0399   3.510 0.000593 ***\nID1987440FM       2.0700     1.0399   1.990 0.048367 *  \nID1987445FM       0.8600     1.0399   0.827 0.409581    \nID1987449FM       1.0700     1.0399   1.029 0.305196    \nID1987451FM       2.8200     1.0399   2.712 0.007482 ** \nID1987452FM       0.6600     1.0399   0.635 0.526633    \nID1987453FM       0.7700     1.0399   0.740 0.460210    \nID1987458FM      -0.5100     1.0399  -0.490 0.624567    \nID1987464FM      -1.7200     1.0399  -1.654 0.100248    \nID1987465FM       1.3600     1.0399   1.308 0.192971    \nID1987470FM      -0.2200     1.0399  -0.212 0.832748    \nID1987476FM       0.2300     1.0399   0.221 0.825267    \nID1987482FM       0.2700     1.0399   0.260 0.795509    \nID1987485FM       0.5300     1.0399   0.510 0.611058    \nID1987492FM      -1.0600     1.0399  -1.019 0.309722    \nID1987493FM      -0.2300     1.0399  -0.221 0.825267    \nID1987494FM       0.9100     1.0399   0.875 0.382959    \nID1987498FM      -0.5100     1.0399  -0.490 0.624567    \nID1987499FM      -0.3800     1.0399  -0.365 0.715329    \nID1987529FM      -0.4600     1.0399  -0.442 0.658893    \nID1987530FM       1.1400     1.0399   1.096 0.274757    \nID1987532FM      -0.6600     1.0399  -0.635 0.526633    \nID1987535FM       0.2000     1.0399   0.192 0.847756    \nID1987539FM       1.9000     1.0399   1.827 0.069699 .  \nID1987545FM      -0.1900     1.0399  -0.183 0.855281    \nID1987567FM       1.3900     1.0399   1.337 0.183390    \nID1987579FM      -0.4600     1.0399  -0.442 0.658893    \nID1988310FM       1.5700     1.0399   1.510 0.133241    \nID1988317FM       4.4700     1.0399   4.298 3.09e-05 ***\nID1988337FM       3.7400     1.0399   3.596 0.000438 ***\nage_sq           -0.3960     0.0265 -14.943  < 2e-16 ***\nage:ID1987346FM  -0.0900     0.3136  -0.287 0.774489    \nage:ID1987347FM  -1.1100     0.3136  -3.540 0.000534 ***\nage:ID1987348FM  -0.3600     0.3136  -1.148 0.252760    \nage:ID1987353FM  -0.5500     0.3136  -1.754 0.081475 .  \nage:ID1987354FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987360FM  -1.3400     0.3136  -4.274 3.42e-05 ***\nage:ID1987365FM  -0.6700     0.3136  -2.137 0.034249 *  \nage:ID1987376FM   0.0200     0.3136   0.064 0.949227    \nage:ID1987383FM  -0.0100     0.3136  -0.032 0.974601    \nage:ID1987389FM  -0.9600     0.3136  -3.062 0.002612 ** \nage:ID1987390FM   0.0400     0.3136   0.128 0.898662    \nage:ID1987393FM  -0.3700     0.3136  -1.180 0.239877    \nage:ID1987399FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987403FM  -0.5000     0.3136  -1.595 0.112919    \nage:ID1987404FM  -0.4000     0.3136  -1.276 0.204052    \nage:ID1987407FM   0.0200     0.3136   0.064 0.949227    \nage:ID1987412FM  -0.3200     0.3136  -1.021 0.309122    \nage:ID1987420FM  -0.7800     0.3136  -2.488 0.013963 *  \nage:ID1987423FM  -0.6100     0.3136  -1.945 0.053607 .  \nage:ID1987429FM  -1.0500     0.3136  -3.349 0.001028 ** \nage:ID1987440FM  -0.0100     0.3136  -0.032 0.974601    \nage:ID1987445FM  -0.8000     0.3136  -2.551 0.011738 *  \nage:ID1987449FM  -0.7100     0.3136  -2.264 0.024996 *  \nage:ID1987451FM  -0.7000     0.3136  -2.232 0.027077 *  \nage:ID1987452FM  -0.9000     0.3136  -2.870 0.004698 ** \nage:ID1987453FM  -0.1700     0.3136  -0.542 0.588514    \nage:ID1987458FM  -0.1900     0.3136  -0.606 0.545469    \nage:ID1987464FM   0.3800     0.3136   1.212 0.227468    \nage:ID1987465FM  -0.3800     0.3136  -1.212 0.227468    \nage:ID1987470FM  -0.2000     0.3136  -0.638 0.524555    \nage:ID1987476FM   0.1500     0.3136   0.478 0.633079    \nage:ID1987482FM  -0.8300     0.3136  -2.647 0.008993 ** \nage:ID1987485FM  -0.5100     0.3136  -1.626 0.105956    \nage:ID1987492FM  -0.1000     0.3136  -0.319 0.750233    \nage:ID1987493FM  -0.4700     0.3136  -1.499 0.136007    \nage:ID1987494FM  -0.4900     0.3136  -1.563 0.120241    \nage:ID1987498FM  -0.4300     0.3136  -1.371 0.172324    \nage:ID1987499FM  -0.5000     0.3136  -1.595 0.112919    \nage:ID1987529FM  -0.9200     0.3136  -2.934 0.003875 ** \nage:ID1987530FM  -0.8800     0.3136  -2.807 0.005678 ** \nage:ID1987532FM  -0.4600     0.3136  -1.467 0.144473    \nage:ID1987535FM  -0.6600     0.3136  -2.105 0.036980 *  \nage:ID1987539FM  -0.7400     0.3136  -2.360 0.019570 *  \nage:ID1987545FM  -0.7500     0.3136  -2.392 0.018008 *  \nage:ID1987567FM  -0.6900     0.3136  -2.201 0.029307 *  \nage:ID1987579FM  -0.6800     0.3136  -2.169 0.031695 *  \nage:ID1988310FM  -0.5500     0.3136  -1.754 0.081475 .  \nage:ID1988317FM  -1.1900     0.3136  -3.795 0.000214 ***\nage:ID1988337FM  -1.9400     0.3136  -6.187 5.63e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7011 on 149 degrees of freedom\nMultiple R-squared:  0.9887,    Adjusted R-squared:  0.981 \nF-statistic: 129.8 on 100 and 149 DF,  p-value: < 2.2e-16\n\n# Extract residuals\nd$res_lm2 <- residuals(m2)\n\n# Make data long for plotting\nd %>% \n  pivot_longer(c(res_lm, res_lm2)) %>% \n  mutate(name2 = ifelse(name == \"res_lm\", \"No ID effect\", \"Age*ID interaction\")) %>% \n  ggplot(aes(ID, value, color = ID)) + \n  facet_wrap(~name2, ncol = 1) +\n  geom_boxplot() +  \n  guides(color = \"none\") +\n  theme(axis.text.x = element_text(angle = 90)) + \n  geom_hline(yintercept = 0, linetype = 2, color = \"tomato3\") + \n  ggtitle(\"Age x ID interaction\")"
  }
]